#!/usr/bin/env groovy
@Library('sim2')_

//log.info 'Starting'
//log.warning 'Nothing to do!'


node{
	
	log.info 'Starting Pipeline'
			stage ('Checkout'){
				    log.info 'Starting'
   					gitCheckOut()
 					log.info 'Finished Check Out'
   
				}
 
			stage('BUILD'){
					log.info 'Starting Build Maven'
    					buildMaven()
    					if(currentBuild.currentResult == 'SUCCESS'){echo "Build is Success ${currentBuild.number}"}
    							
					}
					stage('CLEAN'){
					log.info 'Starting Build TEST'
    					build()
    							
					}
					
 				if (env.BRANCH_NAME == 'master'){

						log.info 'Selected Master Branch'
					
			stage('TEST'){
    
    					buildTest()
  						}
  			 post {
        always {
            echo 'One way or another, I have finished'
            deleteDir() /* clean up our workspace */
        }
        }
   					 }
  			}